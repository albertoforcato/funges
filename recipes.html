<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="canonical" href="https://www.fung.es/recipes.html">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Recipes – Filter by Wild Edibles</title>
  <style>
    body {
      margin: 0;
      padding: 40px;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, rgba(255, 252, 239, 0.95), rgba(240, 240, 230, 0.95));
      color: black;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .container {
      max-width: 900px;
      width: 100%;
      margin: auto;
    }
    .logo {
      width: 250px;
      margin-bottom: 20px;
    }
    .button {
      position: fixed;
      top: 20px;
      right: 35px;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      z-index: 999;
    }
    .button:hover {
      background-color: rgba(0, 0, 0, 1);
    }
    .dropdown-wrapper {
      position: relative;
      display: block;
      margin-bottom: 20px;
      width: 100%;
    }
    #dropdown-toggle {
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      font-size: 16px;
      text-align: center;
      width: 100%;
      box-sizing: border-box;
    }
    #dropdown-panel {
      display: none;
      position: absolute;
      z-index: 999;
      background: white;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 15px;
      max-height: 300px;
      overflow-y: auto;
      width: 100%;
      box-sizing: border-box;
    }
    .emoji-filter {
      font-size: 20px;
      padding: 4px 8px;
      cursor: pointer;
      border-radius: 6px;
      margin: 0 4px;
      transition: background 0.2s ease;
    }
    .emoji-filter:hover {
      background: #ffe;
    }
    .species-option {
      display: flex;
      align-items: center;
      margin: 6px 0;
    }
    .species-option input[type="checkbox"] {
      margin-right: 8px;
    }
    .recipe {
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: white;
      margin-bottom: 20px;
    }
    .recipe h3 {
      margin-top: 0;
    }
  </style>
</head>
<body>
  <button class="button" onclick="closePage()">X</button>
  <script>
    function closePage() {
      if (document.referrer) {
        window.history.back();
      } else {
        window.location.href = 'https://fung.es';
      }
    }
  </script>

  <div class="container">
    <img src="https://raw.githubusercontent.com/lodist/funges/main/icons/logo_funges.webp" alt="Logo" class="logo">
    
    <p style="background: #fff3cd; color: #856404; padding: 12px 16px; border-left: 5px solid #ffa726; border-radius: 6px; margin-bottom: 20px; font-size: 15px;">
      ⚠️ <strong>Foraging Safety:</strong> Always ensure proper identification before foraging. When in doubt, consult a local expert. Some wild foods can have toxic lookalikes or cause adverse reactions in sensitive individuals.
    </p>
        
    <div class="dropdown-wrapper">
      <div id="dropdown-toggle" onclick="toggleDropdown(event)"></div>
      <div id="dropdown-panel">
        <div style="text-align: center; margin-bottom: 10px;">
          <span class="emoji-filter" onclick="setEmojiFilter('🍄')">🍄</span>
          <span class="emoji-filter" onclick="setEmojiFilter('🌱')">🌱</span>
          <span class="emoji-filter" onclick="setEmojiFilter('🌰')">🌰</span>
          <span class="emoji-filter" onclick="setEmojiFilter('🍇')">🍇</span>
          <span class="emoji-filter" onclick="setEmojiFilter('🌸')">🌸</span>
          <span class="emoji-filter" onclick="setEmojiFilter('')">✖️</span>
        </div>
        <div id="species-options"></div>
      </div>
    </div>

    <div id="recipe-list"></div>
  
  </div>

  <script>
    const speciesOptions = {
      "🍄 Porcino (Boletus edulis)": "mushroom",
      "🌱 Amaranth (Amaranthus retroflexus)": "amaranth",
      "🌱 Artichoke (Cynara cardunculus)": "artichoke",
      "🌱 Asparagus (Asparagus acutifolius)": "asparagus",
      "🍄 Chanterelle (Cantharellus cibarius)": "chant",
      "🍄 Chanterelle Black (Craterellus cornucopioides)": "black_chant",
      "🌰 Chestnut (Castanea sativa)": "chestnut",
      "🌱 Chickweed (Stellaria media)": "chickweed",
      "🌸 Dandelion (Taraxacum officinale)": "dandelion",
      "🌱 Garlic (Allium ursinum)": "garlic",
      "🍇 Lingonberry (Vaccinium vitis-idaea)": "lingonb",
      "🌱 Masterwort (Peucedanum ostruthium)": "masterwort",
      "🍄 Morel (Morchella esculenta)": "morel",
      "🌱 Nettle (Urtica dioica)": "nettle",
      "🍄 Parasol (Macrolepiota procera)": "parasol",
      "🍇 Raspberry (Rubus idaeus)": "raspberry",
      "🌱 Sorrel (Rumex acetosa)": "sorrel",
      "🍄 St. George's (Calocybe gambosa)": "st_george",
      "🍇 Strawberry (Fragaria vesca)": "strawberry",
      "🍄 Truffle Black (Tuber melanosporum)": "truffle_b",
      "🌰 Walnut (Juglans regia)": "walnut"
    };
    
    const translations = {
      en: {
        selectIngredients: "Select Ingredients ▼",
        ingredients: "Ingredients:",
        instructions: "Instructions:"
      },
      it: {
        selectIngredients: "Seleziona ingredienti ▼",
        ingredients: "Ingredienti:",
        instructions: "Istruzioni:"
      },
      es: {
        selectIngredients: "Selecciona ingredientes ▼",
        ingredients: "Ingredientes:",
        instructions: "Instrucciones:"
      },
      fr: {
        selectIngredients: "Sélectionnez les ingrédients ▼",
        ingredients: "Ingrédients :",
        instructions: "Instructions :"
      }
    };


    const recipes = {
en: [
{
species: "amaranth,chickweed,sorrel,dandelion",
title: "Amaranth & Wild Greens Patties",
ingredients: `½ cup amaranth seeds<br>
1 cup water<br>
1 cup mixed wild greens (chickweed, sorrel, dandelion), finely chopped<br>
1 small egg<br>
2 tbsp flour or breadcrumbs<br>
Salt, pepper, olive oil`,
instructions: `Cook amaranth: Simmer amaranth seeds in water until all liquid is absorbed (15–20 min). Cool slightly.<br>
Mix: Combine cooked amaranth with chopped greens, egg, flour, salt, and pepper.<br>
Form patties: Shape into small patties with wet hands.<br>
Pan-fry: Heat oil in a skillet and cook patties for 3–4 minutes per side until golden.<br>
Serve: With yogurt sauce, pesto, or as a burger alternative.`
},
{
species: "black_chant",
title: "Black Chanterelle Cream Sauce",
ingredients: `100 g black chanterelles (fresh or 30 g dried)<br>
1 small shallot, finely chopped<br>
1 garlic clove, minced<br>
1 tbsp butter<br>
100 ml white wine (optional)<br>
200 ml cream<br>
Salt and black pepper to taste<br>
Fresh thyme (optional)`,
instructions: `Prepare the mushrooms: If using dried chanterelles, soak them in warm water for 20 minutes, then drain and squeeze gently.<br>
Sauté aromatics: Melt butter in a pan over medium heat. Add the shallot and garlic, cooking until soft and translucent.<br>
Add mushrooms: Stir in the chanterelles and sauté for 5–7 minutes until fragrant and tender.<br>
Deglaze (optional): Add white wine and let it reduce by half.<br>
Cream it up: Pour in the cream and simmer gently for 5 minutes until slightly thickened. Season with salt, pepper, and thyme.<br>
Serve: Excellent over fresh pasta, polenta, or roasted potatoes.`
},
{
species: "chant",
title: "Chanterelle & Herb Tart",
ingredients: `200 g fresh chanterelles<br>1 small leek, finely sliced<br>2 eggs<br>100 ml cream<br>1 tbsp olive oil<br>Fresh thyme and parsley, chopped<br>Salt and pepper to taste<br>1 sheet puff pastry`,
instructions: `Clean mushrooms: Wipe chanterelles clean with a brush or damp cloth.<br>Sauté base: Heat olive oil in a pan, cook leek until soft. Add chanterelles and sauté for 5 minutes. Season.<br>Prepare filling: Beat eggs with cream, herbs, salt, and pepper.<br>Assemble tart: Place pastry in a tart pan. Spread mushrooms and leeks evenly, pour over egg mixture.<br>Bake: Bake at 180°C (356°F) for 25–30 minutes until golden and set.<br>Serve: Warm or cold, perfect for a wild forest brunch.`
}

],
it: [
{
species: "amaranth,chickweed,sorrel,dandelion",
title: "Polpette di Amaranto e Erbe Selvatiche",
ingredients: `½ tazza di semi di amaranto<br>
1 tazza d'acqua<br>
1 tazza di erbe selvatiche miste (centocchio, acetosa, tarassaco), tritate finemente<br>
1 uovo piccolo<br>
2 cucchiai di farina o pangrattato<br>
Sale, pepe, olio d'oliva`,
instructions: `Cuoci l'amaranto: Fai sobbollire i semi di amaranto in acqua finché tutto il liquido è assorbito (15–20 min). Lascia intiepidire.<br>
Mescola: Unisci l'amaranto cotto con le erbe, l'uovo, la farina, sale e pepe.<br>
Forma: Crea delle piccole polpette con le mani umide.<br>
Friggi: Cuoci in padella con olio per 3–4 minuti per lato fino a doratura.<br>
Servi: Con salsa allo yogurt, pesto o come alternativa vegetariana agli hamburger.`
},
{
species: "black_chant",
title: "Salsa Cremosa ai Finferli Neri",
ingredients: `100 g di finferli neri (freschi o 30 g secchi)<br>
1 piccolo scalogno, tritato fine<br>
1 spicchio d'aglio, tritato<br>
1 cucchiaio di burro<br>
100 ml di vino bianco (facoltativo)<br>
200 ml di panna<br>
Sale e pepe nero q.b.<br>
Timo fresco (facoltativo)`,
instructions: `Prepara i funghi: Se usi finferli secchi, mettili a bagno in acqua tiepida per 20 minuti, poi scolali e strizzali.<br>
Soffriggi gli aromi: Sciogli il burro in una padella a fuoco medio. Aggiungi scalogno e aglio e cuoci fino a che saranno morbidi.<br>
Aggiungi i funghi: Unisci i finferli e salta per 5–7 minuti fino a renderli teneri e profumati.<br>
Sfuma (facoltativo): Versa il vino e lascialo ridurre della metà.<br>
Aggiungi la panna: Versa la panna e cuoci a fuoco dolce per 5 minuti fino a che si addensa. Aggiusta di sale, pepe e aggiungi timo.<br>
Servi: Ottima con pasta fresca, polenta o patate arrosto.`
},
{
species: "chant",
title: "Tarte di Finferli e Erbe",
ingredients: `200 g di finferli freschi<br>1 piccolo porro, affettato sottile<br>2 uova<br>100 ml di panna<br>1 cucchiaio di olio d'oliva<br>Timo e prezzemolo freschi, tritati<br>Sale e pepe q.b.<br>1 rotolo di pasta sfoglia`,
instructions: `Pulisci i funghi: Pulisci i finferli con un pennello o un panno umido.<br>Base saltata: Scalda l'olio in padella, cuoci il porro fino a che diventa morbido. Aggiungi i finferli e salta per 5 minuti. Aggiusta di sale.<br>Prepara il ripieno: Sbatti le uova con la panna, le erbe, sale e pepe.<br>Assembla: Disponi la pasta sfoglia in uno stampo, aggiungi funghi e porri, versa sopra il composto di uova.<br>Cottura: Inforna a 180°C per 25–30 minuti fino a doratura.<br>Servi: Calda o fredda, ideale per un brunch nei boschi.`
}

],
es: [
{
species: "amaranth,chickweed,sorrel,dandelion",
title: "Tortitas de Amaranto y Verduras Silvestres",
ingredients: `½ taza de semillas de amaranto<br>
1 taza de agua<br>
1 taza de hojas silvestres variadas (pamplina, acedera, diente de león), picadas finamente<br>
1 huevo pequeño<br>
2 cucharadas de harina o pan rallado<br>
Sal, pimienta, aceite de oliva`,
instructions: `Cocina el amaranto: Hierve las semillas de amaranto en agua hasta que absorban todo el líquido (15–20 min). Deja enfriar un poco.<br>
Mezcla: Combina el amaranto cocido con las verduras, el huevo, la harina, sal y pimienta.<br>
Forma tortitas: Da forma con las manos húmedas.<br>
Fríe: Cocina en sartén con aceite durante 3–4 minutos por lado hasta que estén doradas.<br>
Sirve: Con salsa de yogur, pesto o como alternativa vegetariana de hamburguesa.`
},
{
species: "black_chant",
title: "Salsa Cremosa de Trompetas Negras",
ingredients: `100 g de trompetas negras (frescas o 30 g secas)<br>
1 chalota pequeña, picada fina<br>
1 diente de ajo, picado<br>
1 cucharada de mantequilla<br>
100 ml de vino blanco (opcional)<br>
200 ml de nata para cocinar<br>
Sal y pimienta negra al gusto<br>
Tomillo fresco (opcional)`,
instructions: `Preparar las setas: Si usas trompetas secas, remójalas en agua tibia durante 20 minutos, escúrrelas y sécalas.<br>
Saltear los aromáticos: Derrite la mantequilla en una sartén a fuego medio. Añade chalota y ajo y cocina hasta que estén blandos.<br>
Añadir las setas: Incorpora las trompetas y saltea durante 5–7 minutos hasta que estén tiernas y aromáticas.<br>
Desglasar (opcional): Añade el vino blanco y deja reducir a la mitad.<br>
Añadir la nata: Vierte la nata y cocina a fuego suave durante 5 minutos hasta que espese ligeramente. Salpimenta al gusto y añade tomillo.<br>
Servir: Ideal con pasta fresca, polenta o patatas asadas.`
},
{
species: "chant",
title: "Tarta de Rebozuelos y Hierbas",
ingredients: `200 g de rebozuelos frescos<br>1 puerro pequeño, en rodajas finas<br>2 huevos<br>100 ml de nata para cocinar<br>1 cucharada de aceite de oliva<br>Tomillo y perejil frescos, picados<br>Sal y pimienta al gusto<br>1 lámina de masa de hojaldre`,
instructions: `Limpiar las setas: Limpiar los rebozuelos con un pincel o paño húmedo.<br>Saltear base: Calentar aceite en sartén, cocinar el puerro hasta que esté blando. Añadir los rebozuelos y saltear 5 min. Sazonar.<br>Preparar relleno: Batir huevos con nata, hierbas, sal y pimienta.<br>Montar la tarta: Colocar la masa en el molde, añadir las setas y puerros, verter la mezcla de huevos.<br>Hornear: Hornear a 180°C durante 25–30 min hasta dorar.<br>Servir: Caliente o fría, ideal para brunch silvestre.`
}

],
fr: [
{
species: "amaranth,chickweed,sorrel,dandelion",
title: "Galettes d'Amarante et de Plantes Sauvages",
ingredients: `½ tasse de graines d’amarante<br>
1 tasse d’eau<br>
1 tasse de plantes sauvages mélangées (mouron des oiseaux, oseille, pissenlit), finement hachées<br>
1 petit œuf<br>
2 c. à soupe de farine ou chapelure<br>
Sel, poivre, huile d’olive`,
instructions: `Cuire l’amarante : Faites mijoter les graines d’amarante dans l’eau jusqu’à absorption complète (15–20 min). Laisser tiédir.<br>
Mélanger : Combinez l’amarante cuite avec les plantes, l’œuf, la farine, le sel et le poivre.<br>
Former : Façonnez de petites galettes avec les mains humides.<br>
Faire revenir : Faites cuire dans une poêle avec de l’huile pendant 3–4 min de chaque côté jusqu’à doré.<br>
Servir : Avec une sauce au yaourt, du pesto ou comme alternative végétarienne aux burgers.`
},
{
  species: "black_chant",
  title: "Sauce Crème aux Trompettes de la Mort",
  ingredients: `100 g de trompettes de la mort (fraîches ou 30 g séchées)<br>
1 petite échalote, finement hachée<br>
1 gousse d'ail, émincée<br>
1 c. à soupe de beurre<br>
100 ml de vin blanc (optionnel)<br>
200 ml de crème<br>
Sel et poivre noir au goût<br>
Thym frais (optionnel)`,
  instructions: `Préparer les champignons : Si vous utilisez des champignons secs, les réhydrater 20 min dans de l'eau tiède, puis les égoutter et les presser.<br>
Faire revenir les aromates : Faire fondre le beurre dans une poêle à feu moyen. Ajouter l’échalote et l’ail, cuire jusqu'à ce qu'ils soient tendres.<br>
Ajouter les champignons : Incorporer les trompettes et faire sauter 5–7 min jusqu'à tendreté.<br>
Déglacer (optionnel) : Verser le vin blanc et laisser réduire de moitié.<br>
Ajouter la crème : Verser la crème et mijoter 5 min jusqu'à légère épaississement. Saler, poivrer et ajouter le thym.<br>
Servir : Parfait avec des pâtes fraîches, de la polenta ou des pommes de terre rôties.`
},
{
species: "chant",
title: "Tarte aux Girolles et Herbes",
ingredients: `200 g de girolles fraîches<br>1 petit poireau, finement émincé<br>2 œufs<br>100 ml de crème<br>1 c. à soupe d’huile d’olive<br>Thym et persil frais, hachés<br>Sel et poivre au goût<br>1 pâte feuilletée`,
instructions: `Nettoyer les champignons : Brosser délicatement les girolles ou les essuyer avec un linge humide.<br>Base sautée : Chauffer l’huile, faire revenir le poireau jusqu’à tendreté. Ajouter les girolles, cuire 5 min. Assaisonner.<br>Préparer l’appareil : Battre les œufs avec la crème, les herbes, le sel et le poivre.<br>Assembler : Foncer un moule avec la pâte, disposer les champignons et poireaux, verser l’appareil.<br>Cuire : Enfourner à 180°C pendant 25–30 min jusqu’à coloration dorée.<br>Servir : Chaud ou froid, parfait pour un brunch forestier.`
}

]
};


    let selectedSpecies = [];
    let emojiFilter = "";

    function toggleDropdown(event) {
      const panel = document.getElementById("dropdown-panel");
      panel.style.display = panel.style.display === "block" ? "none" : "block";
      event.stopPropagation();
    }

    function closeDropdownOnClickOutside(e) {
      const panel = document.getElementById("dropdown-panel");
      const toggle = document.getElementById("dropdown-toggle");
      if (!panel.contains(e.target) && e.target !== toggle) {
        panel.style.display = "none";
      }
    }
    document.addEventListener("click", closeDropdownOnClickOutside);

    function setEmojiFilter(emoji) {
      emojiFilter = emoji;
      renderSpeciesOptions();
    }

    function renderSpeciesOptions() {
      const container = document.getElementById("species-options");
      container.innerHTML = "";
      for (const [label, value] of Object.entries(speciesOptions)) {
        if (emojiFilter === "" || label.includes(emojiFilter)) {
          const option = document.createElement("div");
          option.className = "species-option";
          const isChecked = selectedSpecies.includes(value) ? "checked" : "";
          option.innerHTML = `<input type="checkbox" value="${value}" onchange="toggleSpecies(this)" ${isChecked}> ${label}`;
          container.appendChild(option);
        }
      }
    }
    
    function toggleSpecies(checkbox) {
      const value = checkbox.value.trim();
      if (checkbox.checked) {
        if (!selectedSpecies.includes(value)) selectedSpecies.push(value);
      } else {
        selectedSpecies = selectedSpecies.filter(s => s !== value);
      }
      filterRecipes();
    }
    
    function filterRecipes() {
      const allRecipes = document.querySelectorAll(".recipe");
    
      allRecipes.forEach(recipe => {
        const speciesList = recipe.dataset.species.split(',').map(s => s.trim());
        const matches = selectedSpecies.filter(s => speciesList.includes(s));
    
        console.log("🔍 Recipe:", recipe.querySelector("h3").innerText);
        console.log(" - speciesList:", speciesList);
        console.log(" - selectedSpecies:", selectedSpecies);
        console.log(" - matches:", matches);
    
        if (selectedSpecies.length === 0) {
          recipe.style.display = "block";
        } else if (matches.length === selectedSpecies.length) {
          recipe.style.display = "block";
        } else if (matches.length > 0) {
          recipe.style.display = "block";
        } else {
          recipe.style.display = "none";
        }
      });
    }
  
    // 👉 Get species from URL before rendering options
    function getQuerySpecies() {
      const params = new URLSearchParams(window.location.search);
      const ingredients = params.get("ingredients");
      const langParam = params.get("lang") || "en";
      window.currentLang = langParam;      
      const t = translations[window.currentLang] || translations["en"];
          
      if (!ingredients) return;
      selectedSpecies = ingredients.split(",").map(s => s.trim());
    }

    function renderRecipes() {
      const langRecipes = recipes[window.currentLang] || recipes["en"];
      const recipeList = document.getElementById("recipe-list");
      recipeList.innerHTML = "";
      
      langRecipes.forEach(recipe => {
        const recipeDiv = document.createElement("div");
        recipeDiv.className = "recipe";
        recipeDiv.dataset.species = recipe.species;
        recipeDiv.innerHTML = `
          <h3>${recipe.title}</h3>
          <p><strong>${translations[window.currentLang].ingredients}</strong><br>${recipe.ingredients}</p>
          <p><strong>${translations[window.currentLang].instructions}</strong><br>${recipe.instructions}</p>
        `;
        recipeList.appendChild(recipeDiv);
      });
    }

    getQuerySpecies();
    document.getElementById("dropdown-toggle").innerHTML = translations[window.currentLang].selectIngredients;
    renderRecipes(); 
    renderSpeciesOptions();
    filterRecipes();
    
  </script>
</body>
</html>
